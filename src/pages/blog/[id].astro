---
import Layout from "../../layouts/main.astro";
export const prerender = true;

export async function   getStaticPaths  () {
    const data = await fetch(`https://test-subdomain.keyrunasir.com/api/blog/fetchallblogs`)
    const response = await data.json();
    // console.log("res", response);
    return response.post.map((post)=>(
        {
            params:{
                id: post.id.toString()
            },
        }
    ));
};

const {id}= Astro.params;
let blog = null;

try {
    const data = await fetch(`https://test-subdomain.keyrunasir.com/api/blog/fetchoneblog/${id}`);
    const response = await data.json();
    if(response.success){
        blog = response.post;
        console.log("blog", blog)
    } else {
        blog = null;
    }

} catch (error) {
    blog = null;
    
}

---
<Layout title={
    blog.title
} description={
    blog.content
} >
    {
        blog ? <div class="flex flex-col border-[rgb(255,255,255,0.2)] border rounded w-[80%]  px-4 py-2 gap-4 m-auto">
        <p>{
            blog.author
            }</p>
        <p>
            {
                blog.title
            }
        </p>
        <p>
            {
                blog.content
            }
        </p>
        <div class="flex flex-row gap-4">
            <button class="flex flex-row gap-2 border border-[rgb(255,255,255,0.2)] rounded px-2 py-1">
                <span>{
                    blog.likes
                }</span>
                Likes</button>
            <button class="flex flex-row gap-2 border border-[rgb(255,255,255,0.2)] rounded px-2 py-1">
                <span>{
                    blog.likes
                }</span>
                Views</button>
            <button class="flex flex-row gap-2 border border-[rgb(255,255,255,0.2)] rounded px-2 py-1">
                <span>{
                    blog.shares
                }</span>
                Shares</button>
        </div>
    </div> : <div>No Blog found!</div>
    }
</Layout>